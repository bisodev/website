
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://frmsc.com/upload_api_tutorial/" rel="canonical"/>
<link href="../bearer_tutorial/" rel="prev"/>
<link href="../fast_api_tutorial/" rel="next"/>
<link href="../assets/frmsc-logo.png" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.5.6" name="generator"/>
<title>How to use SAFE Upload API? - FRMSc Developer Portal</title>
<link href="../assets/stylesheets/main.50c56a3b.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../assets/style.css" rel="stylesheet"/>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="white" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#when-to-use-safe-application-api">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="FRMSc Developer Portal" class="md-header__button md-logo" data-md-component="logo" href="https://frmsc.com" title="FRMSc Developer Portal">
<img alt="logo" src="../assets/frmsc-logo.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            FRMSc Developer Portal
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              How to use SAFE Upload API?
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="white" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="custom" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
</form>
<script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="..">
          
  
  Concepts

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../bearer_tutorial/">
          
  
  Tutorials

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../API/">
        
  
    
  
  SAFE API Reference

      </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="FRMSc Developer Portal" class="md-nav__button md-logo" data-md-component="logo" href="https://frmsc.com" title="FRMSc Developer Portal">
<img alt="logo" src="../assets/frmsc-logo.png"/>
</a>
    FRMSc Developer Portal
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
<span class="md-ellipsis">
    Concepts
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            Concepts
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
<span class="md-ellipsis">
    Overview of FRMSc
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
<span class="md-ellipsis">
    FRMSc SAFE APIs
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_2">
<span class="md-nav__icon md-icon"></span>
            FRMSc SAFE APIs
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api_overview/">
<span class="md-ellipsis">
    API Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../safe_app_api/">
<span class="md-ellipsis">
    SAFE App API
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../safe_swift_api/">
<span class="md-ellipsis">
    SAFE Swift API
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../uiworkflow/">
<span class="md-ellipsis">
    SAFE Web UI Workflow
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../results_breakdown/">
<span class="md-ellipsis">
    Fatigue and Risk Scales
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../migrate/">
<span class="md-ellipsis">
    Migration from v1 to v2
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../errors/">
<span class="md-ellipsis">
    Troubleshooting
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
<span class="md-ellipsis">
    Tutorials
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../bearer_tutorial/">
<span class="md-ellipsis">
    How to generate a bearer token?
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    How to use SAFE Upload API?
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    How to use SAFE Upload API?
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#when-to-use-safe-application-api">
<span class="md-ellipsis">
      When to use SAFE Application API?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-work-with-the-api">
<span class="md-ellipsis">
      How to work with the API?
    </span>
</a>
<nav aria-label="How to work with the API?" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-generate-a-token">
<span class="md-ellipsis">
      Step 1: Generate a token
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-upload-the-roster-data">
<span class="md-ellipsis">
      Step 2: Upload the roster data
    </span>
</a>
<nav aria-label="Step 2: Upload the roster data" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-set-the-variable-values">
<span class="md-ellipsis">
      Step 1: Set the variable values
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-initiate-request">
<span class="md-ellipsis">
      Step 2: Initiate request
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-prepare-request-body">
<span class="md-ellipsis">
      Step 3: Prepare request body
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-4-make-the-request">
<span class="md-ellipsis">
      Step 4: Make the request
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-generate-result">
<span class="md-ellipsis">
      Step 3: Generate result
    </span>
</a>
<nav aria-label="Step 3: Generate result" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-set-the-variable-values_1">
<span class="md-ellipsis">
      Step 1: Set the variable values
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-initiate-request_1">
<span class="md-ellipsis">
      Step 2: Initiate request
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-make-the-request">
<span class="md-ellipsis">
      Step 3: Make the request
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-4-retry-with-different-datakey">
<span class="md-ellipsis">
      Step 4: Retry with different dataKey
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#complete-code">
<span class="md-ellipsis">
      Complete Code
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../fast_api_tutorial/">
<span class="md-ellipsis">
    How to use SAFE Swift API?
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../API/">
<span class="md-ellipsis">
    SAFE API Reference
  </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#when-to-use-safe-application-api">
<span class="md-ellipsis">
      When to use SAFE Application API?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-work-with-the-api">
<span class="md-ellipsis">
      How to work with the API?
    </span>
</a>
<nav aria-label="How to work with the API?" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-generate-a-token">
<span class="md-ellipsis">
      Step 1: Generate a token
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-upload-the-roster-data">
<span class="md-ellipsis">
      Step 2: Upload the roster data
    </span>
</a>
<nav aria-label="Step 2: Upload the roster data" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-set-the-variable-values">
<span class="md-ellipsis">
      Step 1: Set the variable values
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-initiate-request">
<span class="md-ellipsis">
      Step 2: Initiate request
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-prepare-request-body">
<span class="md-ellipsis">
      Step 3: Prepare request body
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-4-make-the-request">
<span class="md-ellipsis">
      Step 4: Make the request
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-generate-result">
<span class="md-ellipsis">
      Step 3: Generate result
    </span>
</a>
<nav aria-label="Step 3: Generate result" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-set-the-variable-values_1">
<span class="md-ellipsis">
      Step 1: Set the variable values
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-initiate-request_1">
<span class="md-ellipsis">
      Step 2: Initiate request
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-make-the-request">
<span class="md-ellipsis">
      Step 3: Make the request
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-4-retry-with-different-datakey">
<span class="md-ellipsis">
      Step 4: Retry with different dataKey
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#complete-code">
<span class="md-ellipsis">
      Complete Code
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1>How to use SAFE Upload API?</h1>
<div class="admonition info">
<p class="admonition-title"><a href="https://frmsc.blob.core.windows.net/examples/Safe%20API%20Demo%20Client%20-%20Release.zip">Download the C#.NET examples for SAFE APIs with helper library</a></p>
</div>
<h2 id="when-to-use-safe-application-api">When to use SAFE Application API?</h2>
<p>SAFE Application API keeps a copy of your uploaded roster data in the SAFE web app so that you can return to it at any time and analyze the results visually. You should use this API if you want the roster data to be preserved in the SAFE web app.</p>
<h2 id="how-to-work-with-the-api">How to work with the API?</h2>
<p>This code snippet is written in C# and it is used to upload roster data to the FRMSC SAFE Application API and get results from the API. The program uses the following libraries: </p>
<ul>
<li><code>IdentityModel.Client</code></li>
<li><code>Newtonsoft.Json</code></li>
<li><code>Safe_API_Demo_Client.Models</code></li>
<li><code>System.Text</code> </li>
</ul>
<p>Here are the steps to follow. </p>
<h3 id="step-1-generate-a-token"><b>Step 1</b>: Generate a token</h3>
<p>Generate a Bearer token to use with this endpoint. Follow the instructions given in <a href="../bearer_tutorial/">How to generate a Bearer token?</a> tutorial to generate a bearer token.</p>
<h3 id="step-2-upload-the-roster-data"><b>Step 2</b>: Upload the roster data</h3>
<p>Follow the instructions below to upload the roster data. This code sends <code>HTTP POST</code> request to a web API endpoint.</p>
<h4 id="step-1-set-the-variable-values"><b>Step 1</b>: Set the variable values</h4>
<p>Set the values of <code>apiKey</code>, <code>accessToken</code>, <code>rosterCSV</code>, and <code>clientId</code> variables. </p>
<div class="language-C# highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kt">var</span><span class="w"> </span><span class="n">apiKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"[Your_APIKey]"</span><span class="p">;</span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="kt">var</span><span class="w"> </span><span class="n">apiUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"https://web-eu.frmsc.com"</span><span class="p">;</span>
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="kt">var</span><span class="w"> </span><span class="n">accessToken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"[Your_Accesstoken]"</span><span class="p">;</span>
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="kt">var</span><span class="w"> </span><span class="n">rosterCsv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">File</span><span class="p">.</span><span class="n">ReadAllText</span><span class="p">(</span><span class="s">"SampleRosters\\ExampleRosterUpload.csv"</span><span class="p">);</span>
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="kt">var</span><span class="w"> </span><span class="n">clientId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"[Your_ClientId]"</span><span class="p">;</span>
</span></code></pre></div>
<p>You can get <code>apiKey</code> and <code>clientId</code> from the web app, and you can get the <code>accessToken</code> from the previous step.  </p>
<p>The <code>rosterCSV</code> variable is set to read the roster data from a CSV file. Set the parameter value of the <code>File.ReadAllText()</code> function to the location of the CSV file with the roster data.</p>
<h4 id="step-2-initiate-request"><b>Step 2</b>: Initiate request</h4>
<p>Create an HTTP client and set the base address to the API URL. Then, create an HTTP request message with the HTTP method set to POST and the endpoint set to <code>/api/UploadRoster</code>. The request message should also include the <code>authorization</code> header with the access token.</p>
<div class="language-C# highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="n">HttpClient</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">();</span>
</span><span id="__span-1-2"><a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="n">client</span><span class="p">.</span><span class="n">BaseAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Uri</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">);</span>
</span><span id="__span-1-3"><a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a>
</span><span id="__span-1-4"><a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="kt">var</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpRequestMessage</span><span class="p">(</span><span class="n">HttpMethod</span><span class="p">.</span><span class="n">Post</span><span class="p">,</span><span class="w"> </span><span class="s">"/api/UploadRoster"</span><span class="p">);</span>
</span><span id="__span-1-5"><a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a>
</span><span id="__span-1-6"><a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="n">request</span><span class="p">.</span><span class="n">Version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Version</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">);</span>
</span><span id="__span-1-7"><a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">"authorization"</span><span class="p">,</span><span class="w"> </span><span class="s">$"Bearer {accessToken}"</span><span class="p">);</span>
</span></code></pre></div>
<h4 id="step-3-prepare-request-body"><b>Step 3</b>: Prepare request body</h4>
<p>Create an instance of the <code>UploadRequest</code> class and sets its properties. </p>
<div class="language-C# highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kt">var</span><span class="w"> </span><span class="n">uploadRequest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UploadRequest</span>
</span><span id="__span-2-2"><a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="p">{</span>
</span><span id="__span-2-3"><a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">    </span><span class="n">RosterName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Sample SAFE Application API post"</span><span class="p">,</span>
</span><span id="__span-2-4"><a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">    </span><span class="n">RosterData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rosterCsv</span><span class="p">,</span>
</span><span id="__span-2-5"><a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">    </span><span class="n">Username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clientId</span><span class="p">,</span>
</span><span id="__span-2-6"><a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">    </span><span class="n">Key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span>
</span><span id="__span-2-7"><a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">    </span><span class="n">Overwrite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span>
</span><span id="__span-2-8"><a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="p">};</span>
</span></code></pre></div>
<p>The <code>UploadRequest</code> class has four properties.</p>
<ul>
<li><code>RosterName</code></li>
<li><code>RosterData</code></li>
<li><code>Username</code></li>
<li><code>Key</code> </li>
</ul>
<p>Provide a name for the roster through the <code>RosterName</code> property. In the following code example, the <code>RosterName</code> property is set to <code>Sample SAFE Application API post</code>. </p>
<p>Set the RosterData property to refer to <code>rosterCsv</code> and the <code>Username</code> property to <code>clientId</code> variables. The <code>Key</code> property must refer to <code>apiKey</code>. </p>
<p>Leave the <code>Overwrite</code> property as <code>false</code>, if you want to create a new roster. To overwrite an existing roster with the same name, set the value of the <code>Overwrite</code> property to <code>true</code>.</p>
<h4 id="step-4-make-the-request"><b>Step 4</b>: Make the request</h4>
<p>Serialize the <code>UploadRequest</code> object to JSON and set the request message content to the serialized JSON. Send the request message to the API and wait for it to return a roster token.</p>
<div class="language-C# highlight"><pre><span></span><code><span id="__span-3-1"><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="n">request</span><span class="p">.</span><span class="n">Content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringContent</span><span class="p">(</span><span class="n">JsonConvert</span><span class="p">.</span><span class="n">SerializeObject</span><span class="p">(</span><span class="n">uploadRequest</span><span class="p">),</span><span class="w"> </span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span><span class="w"> </span><span class="s">"application/json"</span><span class="p">);</span><span class="w">                  </span>
</span><span id="__span-3-2"><a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a>
</span><span id="__span-3-3"><a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="kt">var</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">SendAsync</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</span><span id="__span-3-4"><a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">ReadAsStringAsync</span><span class="p">();</span>
</span></code></pre></div>
<h3 id="step-3-generate-result"><b>Step 3</b>: Generate result</h3>
<p>Follow the instructions below to upload the roster data. This code sends <code>HTTP GET</code> request to a web API endpoint.</p>
<h4 id="step-1-set-the-variable-values_1"><b>Step 1</b>: Set the variable values</h4>
<p>Set the values of <code>rosterToken</code> and <code>dataKey</code> variables. </p>
<div class="language-C# highlight"><pre><span></span><code><span id="__span-4-1"><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kt">var</span><span class="w"> </span><span class="n">rosterToken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"&lt;roster_token_generated_by_UploadRoster_endpoint&gt;"</span><span class="p">;</span>
</span><span id="__span-4-2"><a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="kt">var</span><span class="w"> </span><span class="n">dataKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"status"</span><span class="p">;</span>
</span></code></pre></div>
<p>You can get <code>rosterToken</code> from <a href="#step-4-make-the-request">Step 4: Make the request</a>. The dataKey variable is set to <code>status</code> initially to ensure that the roster data you uploaded previously was completed successfully. See <a href="#step-4-retry-with-different-datakey">Step 4: Retry with different <code>dataKey</code></a></p>
<h4 id="step-2-initiate-request_1"><b>Step 2</b>: Initiate request</h4>
<p>Create a query string using the variables set in <a href="#step-1-set-the-variable-values_1">Step 1: Set the variable values</a>, including the <code>apiKey</code> variable. Then, create an HTTP request message with the HTTP method set to GET and the endpoint set to <code>/api/GetResults</code>. The request message should also include the <code>authorization</code> header with the access token.</p>
<p>Set the Version property of the <code>HttpRequestMessage</code> object is set to <code>2.0</code> to indicate that the request should use <code>HTTP/2.0</code>.</p>
<div class="language-C# highlight"><pre><span></span><code><span id="__span-5-1"><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kt">var</span><span class="w"> </span><span class="n">queryString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"?token={0}&amp;key={1}&amp;dataKey={2}"</span><span class="p">,</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">,</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="n">dataKey</span><span class="p">);</span>
</span><span id="__span-5-2"><a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="kt">var</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpRequestMessage</span><span class="p">(</span><span class="n">HttpMethod</span><span class="p">.</span><span class="n">Get</span><span class="p">,</span><span class="w"> </span><span class="s">"/api/GetResults"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">queryString</span><span class="p">);</span>
</span><span id="__span-5-3"><a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="n">request</span><span class="p">.</span><span class="n">Version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Version</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">);</span>
</span><span id="__span-5-4"><a href="#__codelineno-5-4" id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">"authorization"</span><span class="p">,</span><span class="w"> </span><span class="s">$"Bearer {accessToken}"</span><span class="p">);</span>
</span></code></pre></div>
<h4 id="step-3-make-the-request"><b>Step 3</b>: Make the request</h4>
<p>Use the <code>SendAsync</code> method of the <code>HttpClient</code> object to send the request, and the <code>ReadAsStringAsync</code> method of the <code>HttpContent</code> object to read the response content as a string.</p>
<div class="language-C# highlight"><pre><span></span><code><span id="__span-6-1"><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kt">var</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">SendAsync</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</span><span id="__span-6-2"><a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">ReadAsStringAsync</span><span class="p">();</span>
</span></code></pre></div>
<h4 id="step-4-retry-with-different-datakey"><b>Step 4</b>: Retry with different <code>dataKey</code></h4>
<p>There are two workflows for this step depending on the response you receive from the previous step.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio"><input id="__tabbed_1_2" name="__tabbed_1" type="radio"><div class="tabbed-labels"><label for="__tabbed_1_1">Response is not <code>completedsuccessfully</code></label><label for="__tabbed_1_2">Response is <code>completedsuccessfully</code></label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>If the response from the previous step is not <code>completedsuccessfully</code>, set the value of <code>dataKey</code> parameter to <code>feedback</code> in Step 1: Set the variable values and retry sending the request to learn more about the problem.</p>
<p>Resolve any error in the roster data file. Then, return to <a href="#step-2-upload-the-roster-data">Step 2: Upload the roster data</a>. Keep the <code>RosterName</code> same and set the value of <code>Overwrite</code> field to <code>true</code> to resubmit the roster data.</p>
</div>
<div class="tabbed-block">
<p>If the status is <code>completedsuccessfully</code>, set the value of <code>dataKey</code> parameter to the type of result you want to receive and submit. The following values are supported for the dataKey parameter. Send <b>only one value</b> at a time.</p>
<p><ul>
<li>status</li>
<li>feedback</li>
<li>hundredpointalertness</li>
<li>samnperellialertness</li>
<li>karolinskaalertness</li>
<li>karolinskaprobability</li>
<li>vigilancedegradation</li>
<li>complexreactiondegradation</li>
<li>percentagemissedresponses</li>
<li>sleepperiods</li>
<li>schedule</li>
<li>timeabovethreshold</li>
<li>tableofscheduledetailsids</li>
</ul></p>
</div>
</div>
</input></input></div>
<h3 id="complete-code">Complete Code</h3>
<div class="language-c# highlight"><pre><span></span><code><span id="__span-7-1"><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="k">using</span><span class="w"> </span><span class="nn">IdentityModel.Client</span><span class="p">;</span>
</span><span id="__span-7-2"><a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="k">using</span><span class="w"> </span><span class="nn">Newtonsoft.Json</span><span class="p">;</span>
</span><span id="__span-7-3"><a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="k">using</span><span class="w"> </span><span class="nn">Safe_API_Demo_Client.Models</span><span class="p">;</span>
</span><span id="__span-7-4"><a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="k">using</span><span class="w"> </span><span class="nn">System.Text</span><span class="p">;</span>
</span><span id="__span-7-5"><a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a>
</span><span id="__span-7-6"><a href="#__codelineno-7-6" id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="k">namespace</span><span class="w"> </span><span class="nn">Safe_API_Demo_Client</span>
</span><span id="__span-7-7"><a href="#__codelineno-7-7" id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="p">{</span>
</span><span id="__span-7-8"><a href="#__codelineno-7-8" id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">UploadApi</span>
</span><span id="__span-7-9"><a href="#__codelineno-7-9" id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-7-10"><a href="#__codelineno-7-10" id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Run</span><span class="p">()</span>
</span><span id="__span-7-11"><a href="#__codelineno-7-11" id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-7-12"><a href="#__codelineno-7-12" id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">identityUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"https://identity-eu.frmsc.com"</span><span class="p">;</span>
</span><span id="__span-7-13"><a href="#__codelineno-7-13" id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">apiUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@"https://web-eu.frmsc.com"</span><span class="p">;</span>
</span><span id="__span-7-14"><a href="#__codelineno-7-14" id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">apiKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"[Your_ApKey]"</span><span class="p">;</span>
</span><span id="__span-7-15"><a href="#__codelineno-7-15" id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">clientId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"[Your_ClientId]"</span><span class="p">;</span>
</span><span id="__span-7-16"><a href="#__codelineno-7-16" id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">clientSecret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"[your_ClientSecret]"</span><span class="p">;</span>
</span><span id="__span-7-17"><a href="#__codelineno-7-17" id="__codelineno-7-17" name="__codelineno-7-17"></a>
</span><span id="__span-7-18"><a href="#__codelineno-7-18" id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">rosterCsv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">File</span><span class="p">.</span><span class="n">ReadAllText</span><span class="p">(</span><span class="s">"SampleRosters\\ExampleRosterUpload.csv"</span><span class="p">);</span>
</span><span id="__span-7-19"><a href="#__codelineno-7-19" id="__codelineno-7-19" name="__codelineno-7-19"></a>
</span><span id="__span-7-20"><a href="#__codelineno-7-20" id="__codelineno-7-20" name="__codelineno-7-20"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">accessToken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">Authenticate</span><span class="p">(</span><span class="n">identityUrl</span><span class="p">,</span><span class="w"> </span><span class="n">clientId</span><span class="p">,</span><span class="w"> </span><span class="n">clientSecret</span><span class="p">,</span><span class="w"> </span><span class="s">"frmsc_safe_upload_api"</span><span class="p">);</span>
</span><span id="__span-7-21"><a href="#__codelineno-7-21" id="__codelineno-7-21" name="__codelineno-7-21"></a>
</span><span id="__span-7-22"><a href="#__codelineno-7-22" id="__codelineno-7-22" name="__codelineno-7-22"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">accessToken</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-7-23"><a href="#__codelineno-7-23" id="__codelineno-7-23" name="__codelineno-7-23"></a>
</span><span id="__span-7-24"><a href="#__codelineno-7-24" id="__codelineno-7-24" name="__codelineno-7-24"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">rosterToken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">Upload</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">,</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="n">accessToken</span><span class="p">,</span><span class="w"> </span><span class="n">rosterCsv</span><span class="p">,</span><span class="w"> </span><span class="n">clientId</span><span class="p">);</span>
</span><span id="__span-7-25"><a href="#__codelineno-7-25" id="__codelineno-7-25" name="__codelineno-7-25"></a>
</span><span id="__span-7-26"><a href="#__codelineno-7-26" id="__codelineno-7-26" name="__codelineno-7-26"></a><span class="w">            </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Acquired token: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">);</span>
</span><span id="__span-7-27"><a href="#__codelineno-7-27" id="__codelineno-7-27" name="__codelineno-7-27"></a>
</span><span id="__span-7-28"><a href="#__codelineno-7-28" id="__codelineno-7-28" name="__codelineno-7-28"></a><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="k">await</span><span class="w"> </span><span class="n">GetResults</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">,</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="n">accessToken</span><span class="p">,</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">,</span><span class="w"> </span><span class="s">"Status"</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"processing"</span><span class="p">)</span>
</span><span id="__span-7-29"><a href="#__codelineno-7-29" id="__codelineno-7-29" name="__codelineno-7-29"></a><span class="w">            </span><span class="p">{</span><span class="w">                </span>
</span><span id="__span-7-30"><a href="#__codelineno-7-30" id="__codelineno-7-30" name="__codelineno-7-30"></a><span class="w">                </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Roster still being processed...."</span><span class="p">);</span>
</span><span id="__span-7-31"><a href="#__codelineno-7-31" id="__codelineno-7-31" name="__codelineno-7-31"></a><span class="w">                </span><span class="n">Thread</span><span class="p">.</span><span class="n">Sleep</span><span class="p">(</span><span class="m">2000</span><span class="p">);</span><span class="w">                </span>
</span><span id="__span-7-32"><a href="#__codelineno-7-32" id="__codelineno-7-32" name="__codelineno-7-32"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-7-33"><a href="#__codelineno-7-33" id="__codelineno-7-33" name="__codelineno-7-33"></a>
</span><span id="__span-7-34"><a href="#__codelineno-7-34" id="__codelineno-7-34" name="__codelineno-7-34"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">feedback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">GetResults</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">,</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="n">accessToken</span><span class="p">,</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">,</span><span class="w"> </span><span class="s">"Feedback"</span><span class="p">);</span>
</span><span id="__span-7-35"><a href="#__codelineno-7-35" id="__codelineno-7-35" name="__codelineno-7-35"></a><span class="w">            </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Feedback: {0}"</span><span class="p">,</span><span class="w"> </span><span class="n">feedback</span><span class="p">);</span>
</span><span id="__span-7-36"><a href="#__codelineno-7-36" id="__codelineno-7-36" name="__codelineno-7-36"></a>
</span><span id="__span-7-37"><a href="#__codelineno-7-37" id="__codelineno-7-37" name="__codelineno-7-37"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">schedules</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">GetResults</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">,</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="n">accessToken</span><span class="p">,</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">,</span><span class="w"> </span><span class="s">"TableOfScheduleDetailsIds"</span><span class="p">);</span>
</span><span id="__span-7-38"><a href="#__codelineno-7-38" id="__codelineno-7-38" name="__codelineno-7-38"></a><span class="w">            </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Schedules: {0}"</span><span class="p">,</span><span class="w"> </span><span class="n">schedules</span><span class="p">);</span>
</span><span id="__span-7-39"><a href="#__codelineno-7-39" id="__codelineno-7-39" name="__codelineno-7-39"></a>
</span><span id="__span-7-40"><a href="#__codelineno-7-40" id="__codelineno-7-40" name="__codelineno-7-40"></a><span class="w">            </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Downloading 100pt scale alertness data"</span><span class="p">);</span>
</span><span id="__span-7-41"><a href="#__codelineno-7-41" id="__codelineno-7-41" name="__codelineno-7-41"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">hundredPointAlertness</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">GetResults</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">,</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="n">accessToken</span><span class="p">,</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">,</span><span class="w"> </span><span class="s">"HundredPointAlertness"</span><span class="p">);</span>
</span><span id="__span-7-42"><a href="#__codelineno-7-42" id="__codelineno-7-42" name="__codelineno-7-42"></a><span class="w">            </span><span class="n">File</span><span class="p">.</span><span class="n">WriteAllText</span><span class="p">(</span><span class="s">"Output\\hundredPointAlertnessData.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">hundredPointAlertness</span><span class="p">);</span>
</span><span id="__span-7-43"><a href="#__codelineno-7-43" id="__codelineno-7-43" name="__codelineno-7-43"></a>
</span><span id="__span-7-44"><a href="#__codelineno-7-44" id="__codelineno-7-44" name="__codelineno-7-44"></a><span class="w">            </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Downloading Samn Perelli scale alertness data"</span><span class="p">);</span>
</span><span id="__span-7-45"><a href="#__codelineno-7-45" id="__codelineno-7-45" name="__codelineno-7-45"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">samnPerelliAlertness</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">GetResults</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">,</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="n">accessToken</span><span class="p">,</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">,</span><span class="w"> </span><span class="s">"SamnPerelliAlertness"</span><span class="p">);</span>
</span><span id="__span-7-46"><a href="#__codelineno-7-46" id="__codelineno-7-46" name="__codelineno-7-46"></a><span class="w">            </span><span class="n">File</span><span class="p">.</span><span class="n">WriteAllText</span><span class="p">(</span><span class="s">"Output\\samnPerelliAlertnessData.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">samnPerelliAlertness</span><span class="p">);</span>
</span><span id="__span-7-47"><a href="#__codelineno-7-47" id="__codelineno-7-47" name="__codelineno-7-47"></a>
</span><span id="__span-7-48"><a href="#__codelineno-7-48" id="__codelineno-7-48" name="__codelineno-7-48"></a><span class="w">            </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Downloading Karolinska Alertness scale alertness data"</span><span class="p">);</span>
</span><span id="__span-7-49"><a href="#__codelineno-7-49" id="__codelineno-7-49" name="__codelineno-7-49"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">karolinskaAlertness</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">GetResults</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">,</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="n">accessToken</span><span class="p">,</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">,</span><span class="w"> </span><span class="s">"KarolinskaAlertness"</span><span class="p">);</span>
</span><span id="__span-7-50"><a href="#__codelineno-7-50" id="__codelineno-7-50" name="__codelineno-7-50"></a><span class="w">            </span><span class="n">File</span><span class="p">.</span><span class="n">WriteAllText</span><span class="p">(</span><span class="s">"Output\\karolinskaAlertnessData.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">karolinskaAlertness</span><span class="p">);</span>
</span><span id="__span-7-51"><a href="#__codelineno-7-51" id="__codelineno-7-51" name="__codelineno-7-51"></a>
</span><span id="__span-7-52"><a href="#__codelineno-7-52" id="__codelineno-7-52" name="__codelineno-7-52"></a><span class="w">            </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Downloading Karolinska Probability scale alertness data"</span><span class="p">);</span>
</span><span id="__span-7-53"><a href="#__codelineno-7-53" id="__codelineno-7-53" name="__codelineno-7-53"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">karolinskaProbability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">GetResults</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">,</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="n">accessToken</span><span class="p">,</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">,</span><span class="w"> </span><span class="s">"KarolinskaProbability"</span><span class="p">);</span>
</span><span id="__span-7-54"><a href="#__codelineno-7-54" id="__codelineno-7-54" name="__codelineno-7-54"></a><span class="w">            </span><span class="n">File</span><span class="p">.</span><span class="n">WriteAllText</span><span class="p">(</span><span class="s">"Output\\karolinskaProbabilityAlertnessData.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">karolinskaProbability</span><span class="p">);</span>
</span><span id="__span-7-55"><a href="#__codelineno-7-55" id="__codelineno-7-55" name="__codelineno-7-55"></a>
</span><span id="__span-7-56"><a href="#__codelineno-7-56" id="__codelineno-7-56" name="__codelineno-7-56"></a><span class="w">            </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Downloading Vigilance Degradation scale alertness data"</span><span class="p">);</span>
</span><span id="__span-7-57"><a href="#__codelineno-7-57" id="__codelineno-7-57" name="__codelineno-7-57"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">vigilanceDegradation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">GetResults</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">,</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="n">accessToken</span><span class="p">,</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">,</span><span class="w"> </span><span class="s">"VigilanceDegradation"</span><span class="p">);</span>
</span><span id="__span-7-58"><a href="#__codelineno-7-58" id="__codelineno-7-58" name="__codelineno-7-58"></a><span class="w">            </span><span class="n">File</span><span class="p">.</span><span class="n">WriteAllText</span><span class="p">(</span><span class="s">"Output\\vigilanceDegradationAlertnessData.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">vigilanceDegradation</span><span class="p">);</span>
</span><span id="__span-7-59"><a href="#__codelineno-7-59" id="__codelineno-7-59" name="__codelineno-7-59"></a>
</span><span id="__span-7-60"><a href="#__codelineno-7-60" id="__codelineno-7-60" name="__codelineno-7-60"></a><span class="w">            </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Downloading Complex Reaction Degradation scale alertness data"</span><span class="p">);</span>
</span><span id="__span-7-61"><a href="#__codelineno-7-61" id="__codelineno-7-61" name="__codelineno-7-61"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">complexReactionDegradation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">GetResults</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">,</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="n">accessToken</span><span class="p">,</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">,</span><span class="w"> </span><span class="s">"ComplexReactionDegradation"</span><span class="p">);</span>
</span><span id="__span-7-62"><a href="#__codelineno-7-62" id="__codelineno-7-62" name="__codelineno-7-62"></a><span class="w">            </span><span class="n">File</span><span class="p">.</span><span class="n">WriteAllText</span><span class="p">(</span><span class="s">"Output\\complexReactionDegradationAlertnessData.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">complexReactionDegradation</span><span class="p">);</span>
</span><span id="__span-7-63"><a href="#__codelineno-7-63" id="__codelineno-7-63" name="__codelineno-7-63"></a>
</span><span id="__span-7-64"><a href="#__codelineno-7-64" id="__codelineno-7-64" name="__codelineno-7-64"></a><span class="w">            </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Downloading Percentage Missed Responses scale alertness data"</span><span class="p">);</span>
</span><span id="__span-7-65"><a href="#__codelineno-7-65" id="__codelineno-7-65" name="__codelineno-7-65"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">percentageMissedResponses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">GetResults</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">,</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="n">accessToken</span><span class="p">,</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">,</span><span class="w"> </span><span class="s">"PercentageMissedResponses"</span><span class="p">);</span>
</span><span id="__span-7-66"><a href="#__codelineno-7-66" id="__codelineno-7-66" name="__codelineno-7-66"></a><span class="w">            </span><span class="n">File</span><span class="p">.</span><span class="n">WriteAllText</span><span class="p">(</span><span class="s">"Output\\percentageMissedResponses.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">percentageMissedResponses</span><span class="p">);</span>
</span><span id="__span-7-67"><a href="#__codelineno-7-67" id="__codelineno-7-67" name="__codelineno-7-67"></a>
</span><span id="__span-7-68"><a href="#__codelineno-7-68" id="__codelineno-7-68" name="__codelineno-7-68"></a><span class="w">            </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Downloading sleep periods data"</span><span class="p">);</span>
</span><span id="__span-7-69"><a href="#__codelineno-7-69" id="__codelineno-7-69" name="__codelineno-7-69"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">sleepPeriods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">GetResults</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">,</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="n">accessToken</span><span class="p">,</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">,</span><span class="w"> </span><span class="s">"SleepPeriods"</span><span class="p">);</span>
</span><span id="__span-7-70"><a href="#__codelineno-7-70" id="__codelineno-7-70" name="__codelineno-7-70"></a><span class="w">            </span><span class="n">File</span><span class="p">.</span><span class="n">WriteAllText</span><span class="p">(</span><span class="s">"Output\\sleepPeriodData.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">sleepPeriods</span><span class="p">);</span>
</span><span id="__span-7-71"><a href="#__codelineno-7-71" id="__codelineno-7-71" name="__codelineno-7-71"></a>
</span><span id="__span-7-72"><a href="#__codelineno-7-72" id="__codelineno-7-72" name="__codelineno-7-72"></a><span class="w">            </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Downloading schedule data"</span><span class="p">);</span>
</span><span id="__span-7-73"><a href="#__codelineno-7-73" id="__codelineno-7-73" name="__codelineno-7-73"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">schedule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">GetResults</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">,</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="n">accessToken</span><span class="p">,</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">,</span><span class="w"> </span><span class="s">"Schedule"</span><span class="p">);</span>
</span><span id="__span-7-74"><a href="#__codelineno-7-74" id="__codelineno-7-74" name="__codelineno-7-74"></a><span class="w">            </span><span class="n">File</span><span class="p">.</span><span class="n">WriteAllText</span><span class="p">(</span><span class="s">"Output\\scheduleData.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">schedule</span><span class="p">);</span>
</span><span id="__span-7-75"><a href="#__codelineno-7-75" id="__codelineno-7-75" name="__codelineno-7-75"></a>
</span><span id="__span-7-76"><a href="#__codelineno-7-76" id="__codelineno-7-76" name="__codelineno-7-76"></a><span class="w">            </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Downloading time above threshold data"</span><span class="p">);</span>
</span><span id="__span-7-77"><a href="#__codelineno-7-77" id="__codelineno-7-77" name="__codelineno-7-77"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">timeAboveThreshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">GetResults</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">,</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="n">accessToken</span><span class="p">,</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">,</span><span class="w"> </span><span class="s">"TimeAboveThreshold"</span><span class="p">);</span>
</span><span id="__span-7-78"><a href="#__codelineno-7-78" id="__codelineno-7-78" name="__codelineno-7-78"></a><span class="w">            </span><span class="n">File</span><span class="p">.</span><span class="n">WriteAllText</span><span class="p">(</span><span class="s">"Output\\timeAboveThresholdData.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">timeAboveThreshold</span><span class="p">);</span>
</span><span id="__span-7-79"><a href="#__codelineno-7-79" id="__codelineno-7-79" name="__codelineno-7-79"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-80"><a href="#__codelineno-7-80" id="__codelineno-7-80" name="__codelineno-7-80"></a>
</span><span id="__span-7-81"><a href="#__codelineno-7-81" id="__codelineno-7-81" name="__codelineno-7-81"></a><span class="w">        </span><span class="k">static</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Upload</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">apiUrl</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">accessToken</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">rosterCsv</span><span class="p">,</span><span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="n">clientId</span><span class="p">)</span>
</span><span id="__span-7-82"><a href="#__codelineno-7-82" id="__codelineno-7-82" name="__codelineno-7-82"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-7-83"><a href="#__codelineno-7-83" id="__codelineno-7-83" name="__codelineno-7-83"></a><span class="w">            </span><span class="n">HttpClient</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">();</span>
</span><span id="__span-7-84"><a href="#__codelineno-7-84" id="__codelineno-7-84" name="__codelineno-7-84"></a><span class="w">            </span><span class="n">client</span><span class="p">.</span><span class="n">BaseAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Uri</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">);</span>
</span><span id="__span-7-85"><a href="#__codelineno-7-85" id="__codelineno-7-85" name="__codelineno-7-85"></a>
</span><span id="__span-7-86"><a href="#__codelineno-7-86" id="__codelineno-7-86" name="__codelineno-7-86"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpRequestMessage</span><span class="p">(</span><span class="n">HttpMethod</span><span class="p">.</span><span class="n">Post</span><span class="p">,</span><span class="w"> </span><span class="s">"/api/UploadRoster"</span><span class="p">);</span>
</span><span id="__span-7-87"><a href="#__codelineno-7-87" id="__codelineno-7-87" name="__codelineno-7-87"></a>
</span><span id="__span-7-88"><a href="#__codelineno-7-88" id="__codelineno-7-88" name="__codelineno-7-88"></a><span class="w">            </span><span class="n">request</span><span class="p">.</span><span class="n">Version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Version</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">);</span>
</span><span id="__span-7-89"><a href="#__codelineno-7-89" id="__codelineno-7-89" name="__codelineno-7-89"></a><span class="w">            </span><span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">"authorization"</span><span class="p">,</span><span class="w"> </span><span class="s">$"Bearer {accessToken}"</span><span class="p">);</span>
</span><span id="__span-7-90"><a href="#__codelineno-7-90" id="__codelineno-7-90" name="__codelineno-7-90"></a>
</span><span id="__span-7-91"><a href="#__codelineno-7-91" id="__codelineno-7-91" name="__codelineno-7-91"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">uploadRequest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UploadRequest</span>
</span><span id="__span-7-92"><a href="#__codelineno-7-92" id="__codelineno-7-92" name="__codelineno-7-92"></a><span class="w">            </span><span class="p">{</span>
</span><span id="__span-7-93"><a href="#__codelineno-7-93" id="__codelineno-7-93" name="__codelineno-7-93"></a><span class="w">                </span><span class="n">RosterName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Sample roster API post"</span><span class="p">,</span>
</span><span id="__span-7-94"><a href="#__codelineno-7-94" id="__codelineno-7-94" name="__codelineno-7-94"></a><span class="w">                </span><span class="n">RosterData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rosterCsv</span><span class="p">,</span>
</span><span id="__span-7-95"><a href="#__codelineno-7-95" id="__codelineno-7-95" name="__codelineno-7-95"></a><span class="w">                </span><span class="n">Username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clientId</span><span class="p">,</span>
</span><span id="__span-7-96"><a href="#__codelineno-7-96" id="__codelineno-7-96" name="__codelineno-7-96"></a><span class="w">                </span><span class="n">Key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span>
</span><span id="__span-7-97"><a href="#__codelineno-7-97" id="__codelineno-7-97" name="__codelineno-7-97"></a><span class="w">                </span><span class="n">Overwrite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span>
</span><span id="__span-7-98"><a href="#__codelineno-7-98" id="__codelineno-7-98" name="__codelineno-7-98"></a><span class="w">            </span><span class="p">};</span>
</span><span id="__span-7-99"><a href="#__codelineno-7-99" id="__codelineno-7-99" name="__codelineno-7-99"></a>
</span><span id="__span-7-100"><a href="#__codelineno-7-100" id="__codelineno-7-100" name="__codelineno-7-100"></a><span class="w">            </span><span class="n">request</span><span class="p">.</span><span class="n">Content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringContent</span><span class="p">(</span><span class="n">JsonConvert</span><span class="p">.</span><span class="n">SerializeObject</span><span class="p">(</span><span class="n">uploadRequest</span><span class="p">),</span><span class="w"> </span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span><span class="w"> </span><span class="s">"application/json"</span><span class="p">);</span><span class="w">                  </span>
</span><span id="__span-7-101"><a href="#__codelineno-7-101" id="__codelineno-7-101" name="__codelineno-7-101"></a>
</span><span id="__span-7-102"><a href="#__codelineno-7-102" id="__codelineno-7-102" name="__codelineno-7-102"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">SendAsync</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</span><span id="__span-7-103"><a href="#__codelineno-7-103" id="__codelineno-7-103" name="__codelineno-7-103"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">ReadAsStringAsync</span><span class="p">();</span>
</span><span id="__span-7-104"><a href="#__codelineno-7-104" id="__codelineno-7-104" name="__codelineno-7-104"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-105"><a href="#__codelineno-7-105" id="__codelineno-7-105" name="__codelineno-7-105"></a>
</span><span id="__span-7-106"><a href="#__codelineno-7-106" id="__codelineno-7-106" name="__codelineno-7-106"></a><span class="w">        </span><span class="k">static</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Authenticate</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">identityUrl</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">clientId</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">clientSecret</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">scope</span><span class="p">)</span>
</span><span id="__span-7-107"><a href="#__codelineno-7-107" id="__codelineno-7-107" name="__codelineno-7-107"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-7-108"><a href="#__codelineno-7-108" id="__codelineno-7-108" name="__codelineno-7-108"></a><span class="w">            </span><span class="n">HttpClient</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">();</span>
</span><span id="__span-7-109"><a href="#__codelineno-7-109" id="__codelineno-7-109" name="__codelineno-7-109"></a><span class="w">            </span><span class="n">client</span><span class="p">.</span><span class="n">BaseAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Uri</span><span class="p">(</span><span class="n">identityUrl</span><span class="p">);</span>
</span><span id="__span-7-110"><a href="#__codelineno-7-110" id="__codelineno-7-110" name="__codelineno-7-110"></a>
</span><span id="__span-7-111"><a href="#__codelineno-7-111" id="__codelineno-7-111" name="__codelineno-7-111"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">openIdDiscoveryDocument</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">GetDiscoveryDocumentAsync</span><span class="p">(</span><span class="n">identityUrl</span><span class="p">).</span><span class="n">GetAwaiter</span><span class="p">().</span><span class="n">GetResult</span><span class="p">();</span>
</span><span id="__span-7-112"><a href="#__codelineno-7-112" id="__codelineno-7-112" name="__codelineno-7-112"></a>
</span><span id="__span-7-113"><a href="#__codelineno-7-113" id="__codelineno-7-113" name="__codelineno-7-113"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ClientCredentialsTokenRequest</span>
</span><span id="__span-7-114"><a href="#__codelineno-7-114" id="__codelineno-7-114" name="__codelineno-7-114"></a><span class="w">            </span><span class="p">{</span>
</span><span id="__span-7-115"><a href="#__codelineno-7-115" id="__codelineno-7-115" name="__codelineno-7-115"></a><span class="w">                </span><span class="n">Address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">openIdDiscoveryDocument</span><span class="p">.</span><span class="n">TokenEndpoint</span><span class="p">,</span>
</span><span id="__span-7-116"><a href="#__codelineno-7-116" id="__codelineno-7-116" name="__codelineno-7-116"></a>
</span><span id="__span-7-117"><a href="#__codelineno-7-117" id="__codelineno-7-117" name="__codelineno-7-117"></a><span class="w">                </span><span class="n">ClientId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clientId</span><span class="p">,</span>
</span><span id="__span-7-118"><a href="#__codelineno-7-118" id="__codelineno-7-118" name="__codelineno-7-118"></a><span class="w">                </span><span class="n">ClientSecret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clientSecret</span><span class="p">,</span>
</span><span id="__span-7-119"><a href="#__codelineno-7-119" id="__codelineno-7-119" name="__codelineno-7-119"></a><span class="w">                </span><span class="n">Scope</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scope</span>
</span><span id="__span-7-120"><a href="#__codelineno-7-120" id="__codelineno-7-120" name="__codelineno-7-120"></a><span class="w">            </span><span class="p">};</span>
</span><span id="__span-7-121"><a href="#__codelineno-7-121" id="__codelineno-7-121" name="__codelineno-7-121"></a>
</span><span id="__span-7-122"><a href="#__codelineno-7-122" id="__codelineno-7-122" name="__codelineno-7-122"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">tokenResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">RequestClientCredentialsTokenAsync</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</span><span id="__span-7-123"><a href="#__codelineno-7-123" id="__codelineno-7-123" name="__codelineno-7-123"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tokenResponse</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
</span><span id="__span-7-124"><a href="#__codelineno-7-124" id="__codelineno-7-124" name="__codelineno-7-124"></a><span class="w">            </span><span class="p">{</span>
</span><span id="__span-7-125"><a href="#__codelineno-7-125" id="__codelineno-7-125" name="__codelineno-7-125"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">tokenResponse</span><span class="p">.</span><span class="n">AccessToken</span><span class="p">;</span>
</span><span id="__span-7-126"><a href="#__codelineno-7-126" id="__codelineno-7-126" name="__codelineno-7-126"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-7-127"><a href="#__codelineno-7-127" id="__codelineno-7-127" name="__codelineno-7-127"></a><span class="w">            </span><span class="k">else</span>
</span><span id="__span-7-128"><a href="#__codelineno-7-128" id="__codelineno-7-128" name="__codelineno-7-128"></a><span class="w">            </span><span class="p">{</span>
</span><span id="__span-7-129"><a href="#__codelineno-7-129" id="__codelineno-7-129" name="__codelineno-7-129"></a><span class="w">                </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">"Authentication failed"</span><span class="p">);</span>
</span><span id="__span-7-130"><a href="#__codelineno-7-130" id="__codelineno-7-130" name="__codelineno-7-130"></a><span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">Exception</span><span class="p">(</span><span class="s">"Authentication failed"</span><span class="p">);</span>
</span><span id="__span-7-131"><a href="#__codelineno-7-131" id="__codelineno-7-131" name="__codelineno-7-131"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-7-132"><a href="#__codelineno-7-132" id="__codelineno-7-132" name="__codelineno-7-132"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-133"><a href="#__codelineno-7-133" id="__codelineno-7-133" name="__codelineno-7-133"></a>
</span><span id="__span-7-134"><a href="#__codelineno-7-134" id="__codelineno-7-134" name="__codelineno-7-134"></a><span class="w">        </span><span class="k">static</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetResults</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">apiUrl</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">accessToken</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">dataKey</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-135"><a href="#__codelineno-7-135" id="__codelineno-7-135" name="__codelineno-7-135"></a><span class="w">            </span><span class="n">HttpClient</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpClient</span><span class="p">();</span>
</span><span id="__span-7-136"><a href="#__codelineno-7-136" id="__codelineno-7-136" name="__codelineno-7-136"></a><span class="w">            </span><span class="n">client</span><span class="p">.</span><span class="n">BaseAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Uri</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">);</span>
</span><span id="__span-7-137"><a href="#__codelineno-7-137" id="__codelineno-7-137" name="__codelineno-7-137"></a>
</span><span id="__span-7-138"><a href="#__codelineno-7-138" id="__codelineno-7-138" name="__codelineno-7-138"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">queryString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">"?token={0}&amp;key={1}&amp;dataKey={2}"</span><span class="p">,</span><span class="w"> </span><span class="n">rosterToken</span><span class="p">,</span><span class="w"> </span><span class="n">apiKey</span><span class="p">,</span><span class="w"> </span><span class="n">dataKey</span><span class="p">);</span>
</span><span id="__span-7-139"><a href="#__codelineno-7-139" id="__codelineno-7-139" name="__codelineno-7-139"></a>
</span><span id="__span-7-140"><a href="#__codelineno-7-140" id="__codelineno-7-140" name="__codelineno-7-140"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpRequestMessage</span><span class="p">(</span><span class="n">HttpMethod</span><span class="p">.</span><span class="n">Get</span><span class="p">,</span><span class="w"> </span><span class="s">"/api/GetResults"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">queryString</span><span class="p">);</span>
</span><span id="__span-7-141"><a href="#__codelineno-7-141" id="__codelineno-7-141" name="__codelineno-7-141"></a>
</span><span id="__span-7-142"><a href="#__codelineno-7-142" id="__codelineno-7-142" name="__codelineno-7-142"></a><span class="w">            </span><span class="n">request</span><span class="p">.</span><span class="n">Version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Version</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">);</span>
</span><span id="__span-7-143"><a href="#__codelineno-7-143" id="__codelineno-7-143" name="__codelineno-7-143"></a><span class="w">            </span><span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">"authorization"</span><span class="p">,</span><span class="w"> </span><span class="s">$"Bearer {accessToken}"</span><span class="p">);</span>
</span><span id="__span-7-144"><a href="#__codelineno-7-144" id="__codelineno-7-144" name="__codelineno-7-144"></a>
</span><span id="__span-7-145"><a href="#__codelineno-7-145" id="__codelineno-7-145" name="__codelineno-7-145"></a><span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">SendAsync</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</span><span id="__span-7-146"><a href="#__codelineno-7-146" id="__codelineno-7-146" name="__codelineno-7-146"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">ReadAsStringAsync</span><span class="p">();</span>
</span><span id="__span-7-147"><a href="#__codelineno-7-147" id="__codelineno-7-147" name="__codelineno-7-147"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-148"><a href="#__codelineno-7-148" id="__codelineno-7-148" name="__codelineno-7-148"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-7-149"><a href="#__codelineno-7-149" id="__codelineno-7-149" name="__codelineno-7-149"></a><span class="p">}</span>
</span></code></pre></div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.expand", "navigation.path", "navigation.tracking", "content.code.copy", "content.code.select"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../assets/javascripts/bundle.e1c3ead8.min.js"></script>
<script>document$.subscribe(() => {
            window.update_swagger_ui_iframe_height = function (id) {
                var iFrameID = document.getElementById(id);
                if (iFrameID) {
                    full_height = (iFrameID.contentWindow.document.body.scrollHeight + 80) + "px";
                    iFrameID.height = full_height;
                    iFrameID.style.height = full_height;
                }
            }
        
            let iframe_id_list = []
            var iframes = document.getElementsByClassName("swagger-ui-iframe");
            for (var i = 0; i < iframes.length; i++) { 
                iframe_id_list.push(iframes[i].getAttribute("id"))
            }
        
            let ticking = true;
            
            document.addEventListener('scroll', function(e) {
                if (!ticking) {
                    window.requestAnimationFrame(()=> {
                        let half_vh = window.innerHeight/2;
                        for(var i = 0; i < iframe_id_list.length; i++) {
                            let element = document.getElementById(iframe_id_list[i])
                            if(element==null){
                                return
                            }
                            let diff = element.getBoundingClientRect().top
                            if(element.contentWindow.update_top_val){
                                element.contentWindow.update_top_val(half_vh - diff)
                            }
                        }
                        ticking = false;
                    });
                    ticking = true;
                }
            });
        
            const dark_scheme_name = "slate"
            
            window.scheme = document.body.getAttribute("data-md-color-scheme")
            const options = {
                attributeFilter: ['data-md-color-scheme'],
            };
            function color_scheme_callback(mutations) {
                for (let mutation of mutations) {
                    if (mutation.attributeName === "data-md-color-scheme") {
                        scheme = document.body.getAttribute("data-md-color-scheme")
                        var iframe_list = document.getElementsByClassName("swagger-ui-iframe")
                        for(var i = 0; i < iframe_list.length; i++) {
                            var ele = iframe_list.item(i);
                            if (ele) {
                                if (scheme === dark_scheme_name) {
                                    ele.contentWindow.enable_dark_mode();
                                } else {
                                    ele.contentWindow.disable_dark_mode();
                                }
                            }
                        }
                    }
                }
            }
            observer = new MutationObserver(color_scheme_callback);
            observer.observe(document.body, options);
            })</script></body>
</html>